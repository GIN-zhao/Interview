## Chapter 1: Compilation & Memory

### C++ program compilation process
Compilation process is divided into four parts: compilation(compilation preprocessing, compilation, optimization and compilation), assembly and linking. 

### compilation preprocessing: process directives starting with #
Compilation,optimization: translate source code .cpp files into assembly code .s files
Assembly: translate assembly code .s files into machine instructions .o files
Linking: Target files(.o files) generated by assembly programs, will not be implemented immediately. Since it happens that functions in .cpp files refer from symbols defined in another .cpp file or use a function from a certain library file. The aim of linking is to connect these files and according target files to a whole, in order to generate executable programs .exe files.

### Two types of linking:
- Static linking: Code is copied from its static linking library to the final executable program. When the program is executing, these codes will be put into the virtual address space of this process.

- Dynamic linking: Code is put into dynamic linking library or certain target file of shared object, linking program just records some information(e.g. name of shared object) in the final executable program. When the program is executing, all content of dynamic linking library will be mapped to according virtual address space.

Pros and Cons:
- Static linking: waste of space; every executable program will have a duplicate of target file, if target file is update, it is necessary to compile,link and generate executable program again( difficulty updating). Running speed is fast, because executable program has all the content of program running.
Dynamic linking: save memory; convenient to update; Linking is necessary for every single time of executing, causing performance loss compared to static linking.

### Memory management

C++ 内存分区：栈、堆、全局/静态存储区、常量存储区、代码区。
- 栈：存放函数的局部变量、函数参数、返回地址等，由编译器自动分配和释放。
- 堆：动态申请的内存空间，就是由 malloc 分配的内存块，由程序员控制它的分配和释放，如果程序执行结束还没有释放，操作系统会自动回收。
- 全局区/静态存储区（.bss 段和 .data 段）：存放全局变量和静态变量，程序运行结束操作系统自动释放，在 C 语言中，未初始化的放在 .bss 段中，初始化的放在 .data 段中，C++ 中不再区分了。
- 常量存储区（.data 段）：存放的是常量，不允许修改，程序运行结束自动释放。
- 代码区（.text 段）：存放代码，不允许修改，但可以执行。编译后的二进制文件存放在这里。

说明：
从操作系统的本身来讲，以上存储区在内存中的分布是如下形式(从低地址到高地址)：.text 段 --> .data 段 --> .bss 段 --> 堆 --> unused --> 栈 --> env

